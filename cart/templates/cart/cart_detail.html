{% extends "base_cart.html"%}

{% load staticfiles%}
{% load humanize%}


{% block title %}
미메이커 '장바구니'
{% endblock %}

{% block content %}
<div class="container">
    <div class="me_title2 col-md-12 co-xs-12">
        <a href="{% url 'cart:cart_detail'%}">
            <span class="glyphicon glyphicon glyphicon-shopping-cart" aria-hidden="true"></span>
            장바구니</a></div>
    <div class="panel panel-success">
        <table class="table table-striped cart">
            <thead class="thead-inverse">
            <tr>
                <th class="col-md-1 col-xs-2">사진</th>
                <th>제품</th>
                <th>수량</th>
                <th>단가</th>
                <th>금액</th>
                <th>삭제</th>
            </tr>
            </thead>
            <tbody>
            {% if cart.isExist > 0 %}
            {% for item in cart %}
            {% with content=item.content %}
            <tr>
                <td>
                    <a href="{{ content.get_absolute_url }}">
                        <img src="{% if content.image %}{{ content.image.first.thumbnail.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}"
                             style="max-width: 100%;height: auto;">
                    </a>
                </td>
                <td><a href="{{ content.get_absolute_url }}">{{ content.title }}</a></td>
                <td>
                    <form action="{% url 'cart:cart_add' content.id %}" method="post">
                        {% csrf_token %}
                        {{ item.update_quantity_form.quantity }}
                        {{ item.update_quantity_form.update }}
                        <button type="submit" class="btn btn-primary">변경</button>
                    </form>
                </td>
                <td class="num">￦{{ item.cost|intcomma }}원</td>
                <td class="num">￦{{ item.total_cost|intcomma }}원</td>
                <td><a href="{% url 'cart:cart_remove' content.id%}">Remove</a></td>
            </tr>

            {% endwith %}
            {% endfor %}
            <tr class="total">
                <td></td>
                <td></td>
                <td></td>
                <td>총액</td>
                <td class="num">￦{{ cart.get_total_cost|intcomma }}원</td>
                <td></td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6">
                    <div class="me_title4_nopadding" align="center">
                        장바구니가 비었습니다.
                    </div>
                </td>
            </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    <div class="col-md-12 co-xs-12">
        <div class="col-md-8"></div>
        <div class="col-md-2">
            <a href="{{prev_page}}">
                <button class="btn btn-success btn-block">되돌아가기</button>
            </a>
        </div>
        <div class="col-md-2">
            {% if cart.isExist > 0 %}
            <a href="{% url 'orders:order_create' %}">
                <button class="btn btn-primary btn-block">구매하기</button>
            </a>
            {% else %}
            <button class="btn btn-primary btn-block " disabled>구매하기</button>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}